<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="饮夏"><link href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" rel="stylesheet"><script>(function(d) {
    var config = {
            kitId: 'mtg4doj',
            scriptTimeout: 3000,
            async: true
        },
        h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
})(document);
</script><title>给网站访问提速. · 饮夏的blog</title><meta name="description" content="自此，网页访问走上了快车道。


这张图片大小是2.19Mb，之前它需要加载8s，而现在正常带宽下1s不到。

图床加速

  受限于服务器带宽，之前的图床访问速度一直不理想， 终于在一个下雨的秋天我决心换掉它。
  现在方案是阿里云的OSS+PicGo+Typora
  可以实现将拷贝进markd"><meta name="keywords" content=""><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/Aplayer.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/Meting.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script>
<style>
.aplayer .aplayer-lrc {
    height: 30px;
  }
.aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #58B2DC
}
.aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
}
.aplayer.aplayer-fixed .aplayer-lrc {
    display: inherit;

}
.aplayer .aplayer-lrc.aplayer-lrc-hide {
    display:none !important;
}
.aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(88, 178,220, 0.8);
}
</style>
<script src="/js/jquery-3.1.0.min.js"></script><script src="/js/jquery.pjax.js"></script><script src="/js/nprogress.js"></script><link rel="stylesheet" href="/css/nprogress.css"><script>

 // 对所有链接跳转事件绑定pjax容器container

$(document).pjax('a[target!=_blank]', '#main-container', {fragment:'#main-container', timeout:8000})
$(document).on('pjax:send', function() {

    NProgress.start();
})
$(document).on('pjax:complete', function() {  NProgress.done();loadMeting();})
</script><meta name="generator" content="Hexo 4.2.1"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body class="night"><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" class="site-title-small"><a href="/" class="a-title">与世界分享世界</a></h3><h1 tabindex="-1" class="site-title-large"><a href="/" class="a-title">饮夏</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/categories">分类</a></li><li><a href="/tags">标签</a></li><li><a href="/414.html"></a></li><li><a href="/400.html"></a></li><li><a href="/404.html"></a></li><li><a href="/500.html"></a></li><li><a href="/501.html"></a></li><li><a href="/403.html"></a></li><li><a href="/502.html"></a></li><li><a href="/503.html"></a></li><li><a href="/p_page_style.css"></a></li><li><a href="/about/index.html">关于</a></li><li class="soc"><a href="https://github.com/sansan-han" target="_blank" rel="noopener noreferrer"><i class="fa fa-github">&nbsp;</i></a><a href="http://weibo.com/u/5943175365" target="_blank" rel="noopener noreferrer"><i class="fa fa-weibo">&nbsp;</i></a><a href="https://blog.yocoh.cn/atom.xml" target="_blank" rel="noopener noreferrer"><i class="fa fa-rss">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2025&nbsp;<a target="_blank" href="https://yocoh.cn" rel="noopener noreferrer">饮夏</a></p><!--input.switch#switch1(type="checkbox" onclick="switchNightMode()")--><p class = "night_switch"  onclick="switchNightMode()" ><script src="https://yocoh.cn/api.php"></script></p>
<style>
.night_switch{
user-select:none;
}
</style>

</footer></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a>给网站访问提速.</a></p><p class="post-meta"><span class="date meta-item">发布于&nbsp;2020-11-23</span><span class="meta-item"><i class="fa fa-folder"></i><span>&nbsp;</span><a href="/categories/blog/" title="blog" class="a-tag">blog</a><span>&nbsp;</span></span><span class="meta-item"><i class="fa fa-tag"></i><span>&nbsp;</span><a href="/tags/访问速度/" title="访问速度" class="a-tag">访问速度</a><span>&nbsp;</span></span></p><p class="post-abstract"><blockquote>
<p>自此，网页访问走上了快车道。</p>
</blockquote>
<p><img src="http://file.yocoh.cn/images/3549d6f9461d683ba9ca6261a98f06ac.png" alt="3549d6f9461d683ba9ca6261a98f06ac"></p>
<p><em>这张图片大小是2.19Mb，之前它需要加载8s，而现在正常带宽下1s不到。</em></p>
<ul>
<li><strong>图床加速</strong></li>
</ul>
<p>  受限于服务器带宽，之前的图床访问速度一直不理想， 终于在一个下雨的秋天我决心换掉它。</p>
<p>  现在方案是阿里云的<a href="http://www.aliyun.com/product/oss?utm_content=se_1005589194" target="_blank" rel="noopener">OSS</a>+<a href="http://molunerfinn.com/PicGo/" target="_blank" rel="noopener">PicGo</a>+<a href="http://typora.io/" target="_blank" rel="noopener">Typora</a></p>
<p>  可以实现将拷贝进markdown的图片自动上传到OSS服务器，并且替换为OSS的链接。</p>
<p>  需要注意的点：</p>
<ul>
<li><p>OSS读写权限设置为公共读。</p>
</li>
<li><p>使用OSS时为了安全考虑最好新建一个子用户，并为其添加<code>AliyunOSSFullAccess</code>权限。</p>
</li>
<li>如果需要对OSS进行GET请求的话，需要在权限管理里进行跨域设置。</li>
<li>可以将OSS绑定自己的域名，只需要在DNS解析那里设置一下就可以了。</li>
<li>Typora的自动上传在文件&gt;偏好设置中。</li>
<li>将之前图床的文件转移使用的是阿里云OSS提供的上传软件<a href="http://gosspublic.alicdn.com/oss-browser/1.13.0/oss-browser-win32-x64.zip?spm=5176.8466032.0.0.2ccb14504DIWwo&amp;file=oss-browser-win32-x64.zip" target="_blank" rel="noopener">ossbrowser</a>，将之前图床的文件打包下载后解压上传。</li>
</ul>
<ul>
<li><strong>资源精简</strong></li>
</ul>
<p>为了好看些，给主页加了一个字体，但是中文字体包通常很大，达到了2Mb+，即使使用OSS也需要1s左右，而且也造成了不必要的流量浪费。</p>
<p><img src="http://file.yocoh.cn/images/image-20201123193515644.png" alt="image-20201123193515644"></p>
<p>其实这么大的字体包，用到的字体也不过就那么几个。</p>
<p>恰好有一个插件<a href="http://www.font-spider.org/" target="_blank" rel="noopener">font-spider</a>可以实现这个功能。</p>
<p>使用也很简单：</p>
<p><strong>安装</strong></p>
<blockquote>
<p>npm install font-spider -g</p>
<p>//全局安装。</p>
</blockquote>
<p><strong>使用</strong></p>
<p>首先得先调用字体文件</p>
<pre class="line-numbers language-lang-css"><code class="language-lang-css">@font-face{
    font-family: 'yourname';
    src:url('someadress.ttf')format('');
    font-weight:normal;
    font-style:normal
}
h1,p{
    font-family:'yourname'
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然后运行命令</p>
<pre><code>font-spider ./index.html
//这里添加想要处理字体的网页，可以使用通配符*，也可以同时添加
//多个文件夹，中间插入空格即可。
</code></pre><p><strong>TIPS</strong></p>
<p>值得注意的一点是，由于一些我暂时不知道的原因，CSS样式可能会导致压缩失败，我在处理的时候除了字体部分的CSS全部注释掉了。</p>
<p>总之2Mb的字体压缩到了70Kb，麻麻再也不用担心我的小霸王不能访问主页了。</p>
<ul>
<li><strong>CDN加速</strong></li>
</ul>
<p>其实CDN加速对我来说毫无必要，通常是访问量比较大的网站会使用CDN，这样子的话即使是离服务器比较远的地方也能够体验良好。</p>
<p>不过最终还是设置了，做个全套嘛，说不定哪天访问量就上来了呢。</p>
<p>不过…如果真上来了，还得担心一下流量费用能不能支付得起，哈哈哈</p>
<p>要说CDN的注意点的话其实也有，CNAME新增最迟15分钟就能生效，但是修改需要48小时，所以其实删除掉再添加会快一些。</p>
<p>还有就是使用CDN和OSS可能会导致https无法正常使用，需要到ssl证书提供商复制证书手动添加，阿里云的https服务是付费使用的，不过比起流量费用的话就微不足道了。</p>
<ul>
<li><strong>写在最后</strong></li>
</ul>
<p>听说，网页加载时长每多1s，访问人数就会减少一半。</p>
<p>无数的web工程师想尽了办法只是为了让加载速度提升微不足道的零点几秒。</p>
<p>看不到的努力，无数个微小的几毫秒。</p>
<p>正是因为你感受不到它的存在，它的存在才显得尤为重要。</p>
<p><em><a href="http://yocoh.cn" target="_blank" rel="noopener">饮夏</a>主页加载速度（810ms)：</em></p>
<p><img src="http://file.yocoh.cn/images/image-20201123200752592.png" alt="image-20201123200752592"></p>
<p><em><a href="http://blog.yocoh.cn">博客</a>加载速度(1909ms)：</em></p>
<p><img src="http://file.yocoh.cn/images/image-20201123201453070.png" alt=""></p>
</p></div><div class="share"><span>分享到</span>&nbsp;<span class="soc"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></span><span class="soc"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></span><span class="soc"><a href="http://twitter.com/home?status=https://blog.yocoh.cn/2020/11/23/给网站访问提速/%20饮夏的blog%20给网站访问提速." target="_blank" rel="noopener" class="fa fa-twitter"></a></span></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/2020/12/30/%E4%BD%95%E5%A6%82%E6%98%AF/" title="何如是"><i class="fa fa-angle-double-left"></i>&nbsp;上一篇: 何如是</a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/2020/11/21/%E6%99%B4%E5%AD%90%E7%9A%84%E4%BF%A1%E3%80%82/" title="晴子的信。">下一篇: 晴子的信。&nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div><section id="vcomments" class="comments"><style>.comments&quot;margin:30px;padding:10px;background:#fff&quot;@@media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#fff}}<key:post class="slug"></key:post><title:post class="title"></title:post></style><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script>new Valine({
    el: "#vcomments",
    app_id: 'gwgMS1U22JvVVcg20JqEy6iu-MdYXbMMI',
    app_key: 'doyHiVx9YrwrOO0daNNT78GA',
    path: window.location.pathname,
    placeholder:'昵称处填写QQ可自动拉取昵称与头像~' ,
    avatar: 'monsterid',
    visiter: 'true',
    enableQQ: 'true'
})</script></section></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2025&nbsp;<a target="_blank" href="https://yocoh.cn" rel="noopener noreferrer">饮夏</a></p><!--input.switch#switch1(type="checkbox" onclick="switchNightMode()")--><p class = "night_switch"  onclick="switchNightMode()" ><script src="https://yocoh.cn/api.php"></script></p>
<style>
.night_switch{
user-select:none;
}
</style>

</footer></div></div><meting-js
            class="aplayer no-destroy"
            server="netease"
            type="playlist"
            id="7128764926"
            fixed="true"
            autoplay="false"
            mutex="true"
            order="random">
    </meting-js><script>
    function switchNightMode(){
        let night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.add('night');
            document.cookie = "night=1;path=/;SameSite=Strict"
            console.log('夜间模式被手动开启啦');
            document.getElementById("switch1").checked=true;
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/;SameSite=Strict"
            console.log('夜间模式被手动关闭啦');
            document.getElementById("switch1").checked=false;
        }
    }

        let box=document.getElementById("switch1");
        let night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
            if(new Date().getHours() >=22 || new Date().getHours() <= 6){
                document.body.classList.add('night');
                document.cookie = "night=1;path=/;SameSite=Strict";
                console.log('夜间模式已开启，夜深啦，早点休息');
                box.checked=true;
            }else{
                document.body.classList.remove('night');
                document.cookie = "night=0;path=/;SameSite=Strict";
                console.log('夜间模式已关闭');
                box.checked=false;
            }
        }else {
            let judge = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
            if (judge == '0') {
                document.body.classList.remove('night');
                console.log('cookie_Night_Mode:OFF');
                box.checked=false;
            } else if (judge == '1') {
                document.body.classList.add('night');
                console.log('cookie_Night_Mode:ON');
                box.checked=true;
                console.log(box.checked);
            }
        }
</script></div></div><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script><script src="/js/img_full.js"></script></body></html>