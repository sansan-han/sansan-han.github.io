---

title: ç»™åšå®¢åŠ ä¸ªå¤œé—´æ¨¡å¼å§
date: 2020-10-26 11:59:18
tags:
- blogæ’ä»¶
categories:
- blog
---





~~ç™½å¤©éƒ½æ— äººé—®æ´¥çš„ç ´ç½‘ç«™ï¼ŒçœŸçš„è¿˜æœ‰äººæ™šä¸Šæ¥å—?~~



- **ç‚¹å‡»æŒ‰é’®åˆ‡æ¢æ¨¡å¼**

å…¶å®å®ç°åŸç†å¾ˆç®€å•:

ç‚¹å‡»`checkbox`çš„æ—¶å€™ï¼Œä¸ºbodyæ–°å¢ï¼ˆæˆ–ç§»é™¤ï¼‰åä¸º`night`çš„classï¼Œ

ç„¶ååœ¨`css`çš„`night.class`é‡ŒåŠ å…¥å¤œé—´æ¨¡å¼çš„ä»£ç ã€‚



```javascript
//åˆ©ç”¨classList.addå‡½æ•°ç»™bodyæ–°å¢ä¸€ä¸ªclass
//jséƒ¨åˆ†
...
function {
		checkbox=document.getElementById("checkbox")
        if(!checkbox.checked){
            document.body.classList.add('night');
            console.log('å¤œé—´æ¨¡å¼å¼€å¯å•¦');
            checkbox.checked=true;
        }else{
            document.body.classList.remove('night');
            console.log('å¤œé—´æ¨¡å¼å…³é—­å•¦');
            checkbox.checked.checked=false;
        }
    }
 ...
 //csséƒ¨åˆ†
 ...
 body.night{
  background: rgba(3,3,3,0.7) no-repeat fixed center;
  color: $night_color;//æ›´æ”¹é¢œè‰²
}
...
//ä¸ºäº†åˆ‡æ¢æ›´å¹³æ»‘ï¼Œåœ¨bodyä¸­åŠ å…¥transition
...
body{
  background: rgba(233, 233, 233, 0.9) no-repeat fixed center;
  background-size: cover;
  transition: background-color 0.6s;
  color:$day_color
}
 ...
```

- **æ ¹æ®æ—¶é—´è‡ªåŠ¨åˆ‡æ¢**

åŠ å…¥ä¸€ä¸ªç®€å•çš„åˆ¤å®šï¼Œè®©å¤œé—´æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢ã€‚

```javascript
if(new Date().getHours() >=22 || new Date().getHours() <= 6){
                document.body.classList.add('night');
                console.log('å¤œé—´æ¨¡å¼å·²å¼€å¯ï¼Œå¤œæ·±å•¦ï¼Œæ—©ç‚¹ä¼‘æ¯');
                box.checked=true;
            }else{
                document.body.classList.remove('night');
                console.log('å¤œé—´æ¨¡å¼å·²å…³é—­');
                box.checked=false;
            }
```

- **åŠ å…¥cookie**

è™½ç„¶æ˜¯æ™šä¸Šï¼Œä½†æ˜¯æˆ‘å°±å–œæ¬¢æ—¥é—´æ¨¡å¼å‘€ï¼Œä¸ºä»€ä¹ˆæˆ‘æ˜æ˜å…³äº†å¤œé—´æ¨¡å¼äº†ï¼Œä¸‹ä¸€ä¸ªé¡µé¢åˆç»™æˆ‘è‡ªåŠ¨æ‰“å¼€äº†ï¼

è¿™ç§æƒ…å†µä¸ç”¨æ€•ï¼Œcookieè½»æ¾è§£å†³å®ƒã€‚

```javascript
//æ–°å¢ä¸€ä¸ªcookieï¼Œå¦‚æœnight=1ï¼Œåˆ™å¼€å¯å¤œé—´æ¨¡å¼ï¼Œå¦åˆ™å…³é—­ã€‚
//å› ä¸ºcookieç¼“å­˜åœ¨æœ¬åœ°ï¼Œæ‰€ä»¥å³ä½¿ç‚¹å¼€æ–°çš„ç½‘é¡µè®¾å®šä¹Ÿä¸ä¼šæ”¹å˜ã€‚
...
//è¿™éƒ¨åˆ†æ˜¯é¡µé¢åŠ è½½æ—¶çš„è‡ªåŠ¨åˆ¤å®šä»£ç 
...
if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === '')//å¦‚æœcookieä¸å­˜åœ¨ï¼Œåˆ™æŒ‰ç…§æ—¶é—´åˆ¤å®šï¼Œå¹¶ä¸”å°†æ­¤æ—¶çš„çŠ¶æ€å†™å…¥cookie
		{
            if(new Date().getHours() >=22 || new Date().getHours() <= 6){
                document.body.classList.add('night');
                document.cookie = "night=1;path=/;SameSite=Strict";
                console.log('å¤œé—´æ¨¡å¼å·²å¼€å¯ï¼Œå¤œæ·±å•¦ï¼Œæ—©ç‚¹ä¼‘æ¯');
                box.checked=true;
            }else{
                document.body.classList.remove('night');
                document.cookie = "night=0;path=/;SameSite=Strict";
                console.log('å¤œé—´æ¨¡å¼å·²å…³é—­');
                box.checked=false;
            }
        }
        else//å¦‚æœcookieå­˜åœ¨ï¼Œåˆ™æŒ‰ç…§cookieä¸­çš„è®¾å®šåˆ‡æ¢å¤œé—´æ¨¡å¼
        {
            let judge = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
            if (judge == '0') {
                document.body.classList.remove('night');
                console.log('cookie_Night_Mode:OFF');
                box.checked=false;
            } else if (judge == '1') {
                document.body.classList.add('night');
                console.log('cookie_Night_Mode:ON');
                box.checked=true;
                console.log(box.checked);
            }
        }
    ...
    //æ‰‹åŠ¨åˆ‡æ¢ä»£ç åŒæ ·ï¼Œåˆ‡æ¢ä¹‹ååŠ å…¥cookieè®°å½•å½“å‰çŠ¶æ€
    //æ­¤æ—¶å¯ä»¥ç”¨cookieä½œä¸ºå¤œé—´æ¨¡å¼çš„åˆ¤å®šï¼Œé¿å…äº†ä½¿ç”¨checkboxä½œ
    //åˆ¤å®šæ—¶ç‚¹å‡»å‡ºé”™çš„é—®é¢˜ã€‚
    ...
    if(night == '0'){
            document.body.classList.add('night');
            document.cookie = "night=1;path=/;SameSite=Strict"
            console.log('å¤œé—´æ¨¡å¼è¢«æ‰‹åŠ¨å¼€å¯å•¦');
            document.getElementById("switch1").checked=true;
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/;SameSite=Strict"
            console.log('å¤œé—´æ¨¡å¼è¢«æ‰‹åŠ¨å…³é—­å•¦');
            document.getElementById("switch1").checked=false;
        }
```

- **å…³äºèƒŒæ™¯çš„ä¸€ä¸ªå°é—®é¢˜ã€‚**

è¿™ä¸ªæ˜¯åœ¨è®¾å®šèƒŒæ™¯å›¾çš„æ—¶å€™å‘ç°çš„ï¼Œè®¾å®šèƒŒæ™¯å›¾ä¸éšé¡µé¢æ»šåŠ¨çš„`background-attachment`å±æ€§åœ¨`ios`é‡Œæ— æ•ˆã€‚

åŸå› æ˜¯`ios`è®¤ä¸ºè¿™ä¸ªæ€§èƒ½å ç”¨è¿‡å¤šæ‰€ä»¥ç¦ç”¨äº†è¿™ä¸ªæ•ˆæœã€‚

æ‰€ä»¥å°±å‡ºç°äº†chromeä¸Šè°ƒè¯•æ˜æ˜æ²¡é—®é¢˜ä½†æ˜¯iPhoneä¸Šå°±æ˜¯ä¸å¯¹åŠ²çš„æƒ…å†µã€‚ã€‚ã€‚

è§£å†³æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ï¼Œåˆ©ç”¨`:before`åœ¨bodyå‰æ–°å¢ä¸€ä¸ªä¼ªç±»ï¼Œç„¶ååœ¨é‡Œé¢å†™`css`å°±ğŸ†—å•¦ã€‚

```css
body:before{
  content: '';
  position: fixed;
  z-index: -1;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
background:url("https://img.yocoh.cn/images/2020/11/01/15972576896501994d72a4b81afc7.jpg") center 0 no-repeat;
  background-size: cover;

}
//å½“ç„¶å¯¹å…¶ä»–å…ƒç´ ä¹Ÿèƒ½å¾—åˆ°ç›¸åº”çš„æ•ˆæœã€‚
```

- **å†™åœ¨æœ€å**

æœ€è¿‘å…¶å®åœ¨blogä¸Šä¿®ä¿®è¡¥è¡¥çš„åœ°æ–¹è›®å¤šçš„ï¼Œä½†æ˜¯éƒ½æ„Ÿè§‰ä¸èƒ½å•ç‹¬å†™ä¸€ç¯‡åšæ–‡ï¼Œè€Œä¸”æ‡’å˜›ï¼Œå°±ä¸€ç›´æ²¡åŠ¨ã€‚

å…¶å®ç°åœ¨çš„å¤œé—´æ¨¡å¼æ˜¯æœ‰ä¸ªå°bugçš„ï¼Œé‚£å°±æ˜¯è‡ªåŠ¨åˆ‡æ¢éƒ¨åˆ†å¦‚æœå½“å‰æ—¶é—´ä¸cookieè®¾å®šå†²çªçš„è¯ï¼Œä¼šé—ªçƒä¸€ä¸‹ã€‚æŸ¥æ‰¾åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨`php`å†™é¡µé¢ï¼Œç„¶ååœ¨bodyå¤„åŠ å…¥`php`ä»£ç å…ˆè¿›è¡Œåˆ¤å®šã€‚

ä½†æ˜¯æš‚æ—¶è¿˜æ²¡æƒ³åˆ°æ€ä¹ˆè¿ç”¨åˆ°ç°åœ¨çš„è¿™ä¸ªä¸»é¢˜ä¸­ã€‚

è¿˜æœ‰å°±æ˜¯å¤œé—´æ¨¡å¼ä¸æ˜¯å¾ˆå¤œé—´ï¼Œæ—¥é—´ä¹Ÿä¸æ˜¯å¾ˆå¥½çœ‹ï¼Œé¢œè‰²ä¹Ÿåªæ˜¯éšä¾¿è°ƒæ•´äº†ä¸€ä¸‹ï¼Œå¹¶æ²¡æœ‰è®¤çœŸçš„å¾®è°ƒï¼Œæ‰€ä»¥æœ‰äº›åœ°æ–¹ä¼šæ˜¾å¾—å¾ˆçªå…€ã€‚

æ¬¢è¿ç‚¹å‡»å³ä¸‹è§’è¯•è¯•ï¼Œç„¶åè¯„è®ºå‘Šè¯‰æˆ‘æ„è§æˆ–å»ºè®®ã€‚

ä»¥ä¸Šã€‚

